version: "2.0"

rules:
- rule: Say hi anytime the user says hi
  steps:
  - intent: greet
  - action: utter_greet

- rule: Say goodbye anytime the user says goodbye
  steps:
  - intent: goodbye
  - action: utter_goodbye

- rule: Say 'I am a bot' anytime the user challenges
  steps:
  - intent: bot_challenge
  - action: utter_iamabot

#Identification
- rule: Change or create ToDo list if user indentifies
  steps:
  - intent: identification
  - action: user_form
  - action: action_create_user
  - action: action_set_user
  - action: action_reset

#View
- rule: View tasks after user's request
  steps:
  - intent: view
  - action: action_read_tasks
  - action: action_reset

#Insert
- rule: insert_task
  steps:
  - intent: insert
  - action: id_task_form
  - action: request_deadline
  - active_loop: request_deadline
  - active_loop: null
  - action: action_add_task

- rule: insert_deadline_alert
  condition:
  - slot_was_set:
    - logical_deadline: True
  steps:
  - intent: affirm
  - action: deadline_form
  - action: request_alert
  - action: action_add_task
  - action: action_reset

- rule: insert_alert
  steps:
  - intent: insert_alert
  - action: alert_form
  - action: id_task_form
  - action: action_add_alert
  - action: action_reset

#Remove
- rule: remove_task
  condition:
    - slot_was_set:
      - tag
  steps:
  - intent: remove
  - action: id_task_form
  - action: action_remove_task
  - action: action_reset

- rule: remove_category
  condition:
    - slot_was_set:
      - category
      - tag: null
  steps:
  - intent: remove
  - action: action_remove_category
  - action: action_reset

- rule: remove_alert
  steps:
  - intent: remove_alert
  - action: id_task_form
  - action: action_remove_alert
  - action: action_reset
  
- rule: remove_user
  condition:
    - slot_was_set:
      - user
  steps:
  - intent: remove
  - action: action_remove_user
  - action: action_reset

#Modify
- rule: modify_task
  steps:
  - intent: modify
  - action: id_task_form
  - action: modify_tag_form
  - action: request_category
  - active_loop: request_category
  - active_loop: null
  - action: action_modify_task_name

- rule: modify_task_category
  condition:
  - slot_was_set:
    - logical_category: True
  steps:
  - intent: affirm
  - action: modify_category_form
  - action: action_move_modify_task
  - action: action_reset

- rule: modify_alert
  steps:
  - intent: modify_alert
  - action: id_task_form
  - action: alert_form
  - action: action_modify_alert
  - action: action_reset

#- rule: modify_deadline
#  steps:
#  - intent: modify
#  - action: id_task_form
#  - action: deadline_form
#  - action: action_modify_deadline
#  - action: action_reset

- rule: modify_user
  condition:
    - slot_was_set:
      - user
  steps:
  - intent: modify
  - action: modify_user_form
  - action: action_rename_user
  - action: action_reset

##Cancel
#- rule: Cancel slot if I say stop
#  steps:
#    - intent: cancel
#    - action: utter_op_deny
#    - action: action_reset
    
#Rephrase
- rule: ask to repeat
  steps:
    - intent: nlu_fallback
    - action: utter_please_rephrase
    - action: action_reset